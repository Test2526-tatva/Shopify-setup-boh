(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function n(t,n,o){return(n=function(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var a=o.call(t,"string");if("object"!==e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(n)?n:String(n)}(n))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}var o=[],a=[{name:"New Zealand",bounds:[[165.21611362034088,-49.69201259953691],[180.05274596705254,-31.35085307747616]],type:"country"},{name:"Auckland",bounds:[[174.56021106142418,-37.09472414962725],[174.9687651385729,-36.606260988828225]],type:"city"}],i=[];google.maps.event.addDomListener(window,"load",(function(){var e=document.getElementById("searchTextField"),t=new google.maps.places.Autocomplete(e,{componentRestrictions:{}});t.addListener("place_changed",(function(){var e=t.getPlace();if(e.geometry&&e.geometry.location&&e.geometry.viewport){if(console.log("place",e),e.geometry.location){var n=e.geometry.location.toJSON(),o=n.lat,a=n.lng,i=new mapboxgl.LngLat(a,o).toBounds(5e3);s.fitBounds(i,{padding:0})}}else window.alert("Invalid address, please select the address from suggestions.")}))})),mapboxgl.accessToken="pk.eyJ1Ijoic3R1ZGlvYWxtb25kIiwiYSI6ImNsMHFlbjE5azAwMWkzY3Fyd29ycDJ4N3IifQ.NcWeaExvFVKu5-_L6h1MEg";var s=new mapboxgl.Map({container:"map",accessToken:mapboxgl.accessToken,style:"mapbox://styles/studioalmond/cl3s98gcg000y15t57fd06bgg",center:{lng:172.37334439463166,lat:-42.24026282612157},zoom:5});window.map=s,s.on("load",(function(){d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQhR1iWO5lrrsR8DIPizkxhaSO4RbPQeElwVInHI_76CSMXYmvPIuI8KqLBmautpOMOKEx3PiP9m7OP/pub?gid=567975238&single=true&output=csv&"+Math.floor(1e3*Math.random())).then((function(e){var r;e.forEach((function(e){""!=e.Name&&+e.Latitude&&+e.Longitude&&o.push(function(e){for(var o=1;o<arguments.length;o++){var a=null!=arguments[o]?arguments[o]:{};o%2?t(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({lat:""!==e.Latitude?+e.Latitude:null,lon:""!==e.Longitude?+e.Longitude:null,name:""+e.Name,center:[+e.Longitude,+e.Latitude],type:"item"},e))})),r=new mapboxgl.LngLatBounds,o.filter((function(e){return null!==e.lat&&null!==e.lon})).forEach((function(e){var t,n=e.lat,o=e.lon;r.extend([o,n]);var a=d(e),i=new mapboxgl.Popup({offset:[0,-32],anchor:"bottom-left",maxWidth:"305px"}).setHTML(a),c=document.createElement("div");c.className="marker",c.style.backgroundImage=liquid__marker,c.style.width="".concat(33,"px"),c.style.height="".concat(49,"px"),c.style.backgroundSize="100%",c.style.cursor="pointer",c.setAttribute("data-ref",l(e)),c.setAttribute("data-repair",null===(t=e.Repair)||void 0===t?void 0:t.toLowerCase()),e.marker=c,$(c).on("click",(function(e){$(".marker--active").removeClass("marker--active"),setTimeout((function(){$(c).addClass("marker--active"),$(".stockists-map").addClass("stockists-map--active-marker")}),50)})),new mapboxgl.Marker(c,{color:"black",offset:[0,0]}).setLngLat({lat:n,lon:o}).setPopup(i).addTo(s)})),s.fitBounds(r,{padding:100}),navigator.geolocation.getCurrentPosition((function(e){var t=[e.coords.longitude,e.coords.latitude];s.setCenter(t),s.setZoom(10)})),function(e){if(e&&0!==e.length){var t=document.getElementById("stores");e.forEach((function(e){var n,o=e.lat,a=e.lon,i=document.createElement("div");i.setAttribute("id",l(e)),i.setAttribute("data-repair",null===(n=e.Repair)||void 0===n?void 0:n.toLowerCase()),i.className="store",i.innerHTML=d(e),i.addEventListener("click",(function(){e.marker&&e.marker.click(),window.innerWidth>992&&s.flyTo({center:{lat:o,lng:a},zoom:13})})),t.appendChild(i)}))}}(o),[].concat(a,i,o)}))})),function(){if(a&&0!==a.length){var e=document.getElementById("countries");a.forEach((function(t){var n=document.createElement("div");n.className="country",n.innerText=t.name,n.addEventListener("click",(function(){s.fitBounds(t.bounds)})),e.appendChild(n)}))}}();var r={},c=1;function l(e){var t=e.Name+e["City/Town"];return r[t]||(r[t]=c,c++),"store-".concat(r[t])}function d(e){var t="\n    ".concat(e["Address Line 1"]?"\n        ".concat(e["Address Line 1"],",\n        <br />\n      "):"","\n\n    ").concat(e["Address Line 2"]?"\n        ".concat(e["Address Line 2"],",\n        <br />\n      "):"","\n    \n    ").concat(e["City/Town"],", ").concat(e["Postal Code"],", ").concat(e["State/Province"],",\n    <br />\n    ").concat(e.Country,"\n  ");return'\n  <div class="md-hide">\n    <div class="store__desc" >\n      <h6>'.concat(e.Name,'</h6>\n      <div class="store__desc--grid">\n        <div class="store__desc--left">\n          <p class="p-small">').concat(e["City/Town"],'</p>           \n        </div>\n        <div class="store__desc--right">\n          <p class="p-small">\n            \n           ').concat(t,'\n\n          </p>\n          \n          <p>&nbsp;</p>\n          <div class="contacts p-small">\n            <span>\n              ').concat(e.Phone,'\n            </span>\n            \n            <a href="').concat(e.Website,'" target="_blank">Website</a>\n              \n          </div>\n          \n          <a target="_blank" class="p-small store__directions" href="http://maps.google.com/maps?q=').concat(encodeURIComponent(t),'" target="_blank">Get Directions</a>\n        </div>\n      </div>\n    </div>\n\n    <div class="store-marker">\n      <svg width="48" height="70" viewBox="0 0 48 70" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M47.7647 24.2722C47.7647 10.8677 37.0713 0 23.8824 0C10.6932 0 0 10.8679 0 24.2722C0 32.876 11.4809 51.8368 19.2546 64.6751C20.1336 66.1268 20.9652 67.5002 21.7275 68.7715C22.7062 70.4117 25.0561 70.4073 26.0372 68.7715C26.7979 67.5029 27.6277 66.1326 28.5047 64.6842C36.2789 51.8458 47.7647 32.8779 47.7647 24.2722Z" fill="#484646"/>\n        <path d="M31.6812 21.3165C31.6812 20.9981 31.7671 20.6568 31.9218 20.3634C32.6452 18.9878 32.9545 17.8974 32.9545 16.7216C32.9545 12.8322 29.8372 10 25.5592 10H15.8828V36H27.6037C32.6891 36 35.8828 33.149 35.8828 28.6104C35.8828 26.2838 34.8883 24.6065 32.3131 22.5172C31.8988 22.1801 31.6812 21.766 31.6812 21.3165Z" fill="#F7D233"/>\n      </svg>\n    </div>\n  </div>\n\n\n  <div class="md-show">\n    <div class="accordion">\n      <div class="accordion-item">\n        <div class="accordion-item__label">\n          <label>\n            ').concat(e.Name,"\n            <span>").concat(e["City/Town"],'</span>\n          </label>\n              \n          <div class="accordion-item__icon">\n            <div class="active">\n              <svg width="14" height="8" viewBox="0 0 14 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M13 7L7.70711 1.70711C7.31658 1.31658 6.68342 1.31658 6.29289 1.70711L1 7" stroke="#ffffff" stroke-width="2" stroke-linecap="round"></path>\n              </svg>\n            </div>\n            <div class="default">\n              <svg width="14" height="8" viewBox="0 0 14 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M1 1L6.29289 6.29289C6.68342 6.68342 7.31658 6.68342 7.70711 6.29289L13 1" stroke="#ffffff" stroke-width="2" stroke-linecap="round"></path>\n              </svg>\n            </div>\n          </div>\n        </div>\n        <div class="accordion-item__collapse">\n          <div class="accordion-item__content"> \n          <div class="store__desc" >\n            <div class="store__desc--grid">\n              <div class="store__desc--left">\n                <p class="p-small">').concat(e["City/Town"],'</p>           \n              </div>\n              <div class="store__desc--right">\n                <p class="p-small">\n                  ').concat(t,",\n                  <br />\n                  ").concat(e["City/Town"],'    \n                  <br />     \n                  <br />\n                  \n                  <a target="_blank" href="http://maps.google.com/maps?q=').concat(encodeURIComponent(t),'" class="underline-link underline-link--light get-directions">Get Directions</a>   \n                  \n                  <br />\n                </p>\n                \n                <p class="md-hide">&nbsp;</p>\n                <div class="contacts p-small">\n                  <span>\n                    ').concat(e.Phone,'\n                  </span>\n                  \n                  <a href="').concat(e.Website,'" target="_blank">Website</a>\n                </div>\n                \n              </div>\n            </div>\n          </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="store-marker">\n      <svg width="48" height="70" viewBox="0 0 48 70" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M47.7647 24.2722C47.7647 10.8677 37.0713 0 23.8824 0C10.6932 0 0 10.8679 0 24.2722C0 32.876 11.4809 51.8368 19.2546 64.6751C20.1336 66.1268 20.9652 67.5002 21.7275 68.7715C22.7062 70.4117 25.0561 70.4073 26.0372 68.7715C26.7979 67.5029 27.6277 66.1326 28.5047 64.6842C36.2789 51.8458 47.7647 32.8779 47.7647 24.2722Z" fill="#484646"/>\n        <path d="M31.6812 21.3165C31.6812 20.9981 31.7671 20.6568 31.9218 20.3634C32.6452 18.9878 32.9545 17.8974 32.9545 16.7216C32.9545 12.8322 29.8372 10 25.5592 10H15.8828V36H27.6037C32.6891 36 35.8828 33.149 35.8828 28.6104C35.8828 26.2838 34.8883 24.6065 32.3131 22.5172C31.8988 22.1801 31.6812 21.766 31.6812 21.3165Z" fill="#F7D233"/>\n      </svg>\n    </div>\n  </div>\n  ')}function m(){var e=$("#stores > .store:visible").length;0==e?$("#stores-count").html("No Results"):$("#stores-count").html("".concat(e," Stores"))}$(".stockists-map").on("click",(function(){$(".stockists-map").removeClass("stockists-map--active-marker"),$(".marker--active").removeClass("marker--active")})),s.on("move",(function(e){var t=function(){for(var e,t,n=s.getContainer(),o=n.getElementsByClassName("marker"),a=n.getBoundingClientRect(),i=[],r=0;r<o.length;r++){var c=o.item(r);e=a,!((t=c.getBoundingClientRect()).left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)&&i.push("#"+c.getAttribute("data-ref"))}return i}();$(".stockists-stores > .store").hide(),$(t.join(",")).show()})),document.addEventListener("DOMContentLoaded",(function(){$(".stockists-sidebar__tab-links a").on("click",(function(e){e.preventDefault();var t=$(this).closest("li").index();$(".stockists-sidebar__tab-links .tab-active").removeClass("tab-active"),$(this).addClass("tab-active"),$("body").toggleClass("only-repairs",1==t),$(".stockists-map--active-marker").removeClass("stockists-map--active-marker"),$(".mapboxgl-popup").remove(),m()}))})),new MutationObserver(m).observe(document.querySelector("#stores"),{attributes:!0,childList:!0,subtree:!0})})();