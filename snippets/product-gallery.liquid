<div class='product-main__gallery'>
  <div class='swiper'>
    <div class='swiper-wrapper'>
      {% for image in product.images %}
        {% assign variant_ids = '' %}
        {% for variant in image.variants %}
          {% assign variant_ids = variant_ids | append: variant.id %}
          {% if forloop.last == false %}
            {% assign variant_ids = variant_ids | append: ',' %}
          {% endif %}
        {% endfor %}

        <div variant-ids='{{ variant_ids }}' data-variant-id='{{ image.variants.first.id }}' class='swiper-slide'>
          <img src='{{ image.src | img_url: 'master' }}' alt='{{ image.alt }}'>
        </div>
      {% endfor %}

      {% for media in product.media %}
        {% if media.media_type == 'video' %}
          <div class='swiper-slide'>
            {% render 'media', media: media %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <div class='product-main__arrow product-main__arrow--next'>
      {% render 'icon-swiper-next' %}
    </div>
    <div class='product-main__arrow product-main__arrow--prev'>
      {% render 'icon-swiper-prev' %}
    </div>
  </div>

  {% render 'product-hint', classes: 'md-hide' %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const hint = document.querySelector('.product__hint');
    const scrollDistance = 600;

    function updateHintPosition() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const progress = Math.min(scrollTop / scrollDistance, 1);
      const translateY = 100 - progress * 100;

      hint.style.transform = `translateY(${translateY}%)`;
    }

    window.addEventListener('scroll', updateHintPosition);
    updateHintPosition();
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const swiper = new Swiper('.product-main__gallery .swiper', {
      slidesPerView: 1,
      breakpoints: {
        768: {
          slidesPerView: 2,
          spaceBetween: 8,
        },
      },
      navigation: {
        nextEl: '.product-main__arrow--next',
        prevEl: '.product-main__arrow--prev',
      },
      on: {
        click: function (swiper) {
          swiper.slideNext();
        },
      },
    });
  });
</script>
